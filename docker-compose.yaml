version: "3.7"
services:

# ##########################################################################
# MOADSD-NG Server
# ##########################################################################
  moadsd-ng-server:
    container_name: moadsd-ng-server
    # image: moadsd-ng-server:latest
    build:
      context: .
      args:
        uid: 1001
        gid: 1001
    volumes:
      - ~/moadsd-ng-server/workdir/moadsd-ng:/home/ansible/moadsd-ng
      - ~/moadsd-ng-server/workdir/ansible.json:/home/ansible/ansible.json
      - ~/moadsd-ng-server/workdir/.vault-pass.txt:/home/ansible/.vault-pass.txt
      - ~/moadsd-ng-server/workdir/.aws:/home/ansible/.aws
      - ~/moadsd-ng-server/workdir/.config:/home/ansible/.config
      - ~/moadsd-ng-server/workdir/.ssh/moadsd-ng:/home/ansible/.ssh/moadsd-ng
      - ~/moadsd-ng-server/workdir/.ssh/id_rsa:/home/ansible/.ssh/id_rsa
      - ~/moadsd-ng-server/workdir/.ssh/id_rsa.pub:/home/ansible/.ssh/id_rsa.pub
      - type: bind
        source: /etc/timezone
        target: /etc/timezone
        read_only: true
    environment:
      - TZ=Europe/Berlin
      - DEBIAN_FRONTEND=noninteractive
    stdin_open: true
    tty: true
    restart: always
    network_mode: host
